<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="../img/sares.jpeg" type="image/x-icon">
    <link rel="stylesheet" href="../css/genericDesign.css">
    <link rel="stylesheet" href="../css/Modulo-VisualizacionGeneral.css">
    <title>Visualización General</title>
</head>

<body>
    <div class="header">
        <div class="logos">
            <img src="../img/sep.png" alt="Logo SEP">
            <img src="../img/tecnm.jpg" alt="TECNM Logo">
            <img src="../img/tec.png" alt="ITL Logo">
            <img src="../img/sares.jpeg" alt="SARES Logo">
        </div>
        <div class="user-profile" onclick="toggleMenu()">
            <img src="" alt="Foto de Perfil" id="profileImage">
            <span class="menu-icon"><img src="../img/list.svg"></span>
        </div>
        <div class="menu-dropdown" id="menuDropdown">
            <ul id="menuList">
                <!-- Contenido dinámico del menú -->
            </ul>
        </div>
    </div>

    <!-- Contenido principal -->
    <div class="main-content">
        <div class="welcome-text">
            <h1 id="bienvenida">Visualización General </h1>
        </div>
        <!-- Tabla de datos -->
        <div class="table-container">
            <div class="table-header">
                <h2 class="table-title">Listado de Datos</h2>
                <input type="text" class="search-box" placeholder="Buscar..." id="searchInput">
            </div>

            <table id="dataTable">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Clave</th>
                        <th>Nombre</th>
                        <th>Fecha</th>
                        <th>Hora</th>
                        <th>Tipo Registro</th>
                        <th>Usuario</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Los datos se cargarán con JavaScript -->
                </tbody>
            </table>

            <div class="pagination">
                <button class="page-btn">Anterior</button>
                <button class="page-btn active">1</button>
                <button class="page-btn">2</button>
                <button class="page-btn">3</button>
                <button class="page-btn">Siguiente</button>
            </div>
        </div>

    </div>
    <!-- Modal para editar registro -->
    <div class="modal-overlay" id="editModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Editar Registro</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="editForm">
                    <input type="hidden" id="editId">
                    <div class="form-group">
                        <label for="editClave">Clave:</label>
                        <input type="text" id="editClave" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="editNombre">Nombre:</label>
                        <input type="text" id="editNombre" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="editFecha">Fecha:</label>
                        <input type="date" id="editFecha" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="editHora">Hora:</label>
                        <input type="time" id="editHora" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="editTipoRegistro">Tipo Registro:</label>
                        <input type="text" id="editTipoRegistro" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="editUsuario">Usuario:</label>
                        <input type="text" id="editUsuario" class="form-control" required>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary close-modal">Cancelar</button>
                <button class="btn btn-primary" id="saveEdit">Guardar Cambios</button>
            </div>
        </div>
    </div>

    <!-- Modal para confirmar eliminación -->
    <div class="modal-overlay" id="deleteModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Confirmar Eliminación</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <p>¿Está seguro que desea eliminar este registro? Esta acción no se puede deshacer.</p>
                <input type="hidden" id="deleteId">
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary close-modal">Cancelar</button>
                <button class="btn btn-danger" id="confirmDelete">Eliminar</button>
            </div>
        </div>
    </div>

    <div class="footer">© Sares TL, 2024</div>

    <script>
        // Función para alternar el menú desplegable
        function toggleMenu() {
            const menu = document.getElementById('menuDropdown');
            menu.classList.toggle('open');
        }

        // Datos de ejemplo para la tabla
        let sampleData = [
            { id: 1, clave: "A001", nombre: "Juan Pérez", fecha: "2024-04-01", hora: "08:30", tipoRegistro: "Ingreso", usuario: "Admin" },
            { id: 2, clave: "A002", nombre: "María López", fecha: "2024-04-02", hora: "09:15", tipoRegistro: "Egreso", usuario: "User" },
            { id: 3, clave: "A003", nombre: "Carlos Gómez", fecha: "2024-04-03", hora: "10:00", tipoRegistro: "Ingreso", usuario: "Admin" },
            { id: 4, clave: "A004", nombre: "Ana Martínez", fecha: "2024-04-04", hora: "11:30", tipoRegistro: "Egreso", usuario: "User" },
            { id: 5, clave: "A005", nombre: "Roberto Sánchez", fecha: "2024-04-05", hora: "14:00", tipoRegistro: "Ingreso", usuario: "Admin" }
        ];

        // Función para cargar los datos en la tabla
        function loadTableData(data) {
            const tableBody = document.querySelector('#dataTable tbody');
            tableBody.innerHTML = '';

            data.forEach(item => {
                const row = document.createElement('tr');

                // Crear celdas para cada propiedad
                const idCell = document.createElement('td');
                idCell.textContent = item.id;

                const claveCell = document.createElement('td');
                claveCell.textContent = item.clave;

                const nombreCell = document.createElement('td');
                nombreCell.textContent = item.nombre;

                const fechaCell = document.createElement('td');
                fechaCell.textContent = item.fecha;

                const horaCell = document.createElement('td');
                horaCell.textContent = item.hora;

                const tipoRegistroCell = document.createElement('td');
                tipoRegistroCell.textContent = item.tipoRegistro;

                const usuarioCell = document.createElement('td');
                usuarioCell.textContent = item.usuario;

                const accionesCell = document.createElement('td');

                // Botón de editar
                const editBtn = document.createElement('button');
                editBtn.className = 'action-btn';
                editBtn.textContent = 'Editar';
                editBtn.addEventListener('click', () => openEditModal(item));

                // Botón de eliminar
                const deleteBtn = document.createElement('button');
                deleteBtn.className = 'action-btn delete-btn';
                deleteBtn.textContent = 'Eliminar';
                deleteBtn.addEventListener('click', () => openDeleteModal(item.id));

                accionesCell.appendChild(editBtn);
                accionesCell.appendChild(deleteBtn);

                // Añadir celdas a la fila
                row.appendChild(idCell);
                row.appendChild(claveCell);
                row.appendChild(nombreCell);
                row.appendChild(fechaCell);
                row.appendChild(horaCell);
                row.appendChild(tipoRegistroCell);
                row.appendChild(usuarioCell);
                row.appendChild(accionesCell);

                // Añadir fila a la tabla
                tableBody.appendChild(row);
            });
        }

        // Función para abrir el modal de edición
        function openEditModal(item) {
            document.getElementById('editId').value = item.id;
            document.getElementById('editClave').value = item.clave;
            document.getElementById('editNombre').value = item.nombre;
            document.getElementById('editFecha').value = item.fecha;
            document.getElementById('editHora').value = item.hora;
            document.getElementById('editTipoRegistro').value = item.tipoRegistro;
            document.getElementById('editUsuario').value = item.usuario;

            document.getElementById('editModal').style.display = 'block';
        }

        // Función para guardar los cambios de edición
        document.getElementById('saveEdit').addEventListener('click', () => {
            const id = document.getElementById('editId').value;
            const clave = document.getElementById('editClave').value;
            const nombre = document.getElementById('editNombre').value;
            const fecha = document.getElementById('editFecha').value;
            const hora = document.getElementById('editHora').value;
            const tipoRegistro = document.getElementById('editTipoRegistro').value;
            const usuario = document.getElementById('editUsuario').value;

            // Actualizar el dato en el arreglo de datos
            const index = sampleData.findIndex(item => item.id == id);
            sampleData[index] = { id, clave, nombre, fecha, hora, tipoRegistro, usuario };

            loadTableData(sampleData);
            closeModal();
        });

        // Función para abrir el modal de eliminación
        function openDeleteModal(id) {
            document.getElementById('deleteId').value = id;
            document.getElementById('deleteModal').style.display = 'block';
        }

        // Función para eliminar un registro
        document.getElementById('confirmDelete').addEventListener('click', () => {
            const id = document.getElementById('deleteId').value;

            // Eliminar el registro del arreglo de datos
            sampleData = sampleData.filter(item => item.id != id);

            loadTableData(sampleData);
            closeModal();
        });

        // Función para cerrar los modales
        function closeModal() {
            document.getElementById('editModal').style.display = 'none';
            document.getElementById('deleteModal').style.display = 'none';
        }

        // Cargar la tabla al inicio
        loadTableData(sampleData);
    </script>
</body>

</html>
